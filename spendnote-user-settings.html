<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow">
    <meta name="description" content="Manage your account settings in SpendNote.">
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="alternate icon" type="image/x-icon" href="favicon.ico">
    <title>Account Settings - SpendNote</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="assets/css/main.css?v=12">
    <link rel="stylesheet" href="assets/css/app-layout.css?v=14">
    <link rel="stylesheet" href="assets/css/user-settings.css?v=20260217-0142">
</head>
<body>
<div id="nav-container"></div>

<div class="app-container">
    <main class="main-content">
        <div class="page-header">
            <div class="page-title-group">
                <h1 class="page-title">Account Settings</h1>
                <p class="page-subtitle">Manage your profile, team, subscription, and preferences.</p>
            </div>
        </div>

        <div class="settings-layout">
            <!-- LEFT COLUMN -->
            <div>
                <!-- PROFILE -->
                <div class="settings-card">
                    <div class="settings-card-header">
                        <div>
                            <div class="settings-card-title">Profile</div>
                            <div class="settings-card-subtitle">Your personal information and avatar</div>
                        </div>
                    </div>
                    <div class="profile-avatar-section">
                        <div class="avatar-preview-circle" id="avatarPreview">
                            <span id="avatarInitials">—</span>
                            <img id="avatarImg" alt="Avatar" draggable="false">
                        </div>
                        <div class="avatar-controls">
                            <div class="avatar-color-row">
                                <label style="font-size: 13px; font-weight: 600; color: var(--text); margin-bottom: 8px; display: block;">Monogram Color</label>
                                <div class="avatar-color-swatches" id="avatarColorSwatches">
                                    <button type="button" class="avatar-color-swatch" data-color="#3a9b7a" style="background:#3a9b7a;"></button>
                                    <button type="button" class="avatar-color-swatch" data-color="#3b8f8a" style="background:#3b8f8a;"></button>
                                    <button type="button" class="avatar-color-swatch" data-color="#4a84b6" style="background:#4a84b6;"></button>
                                    <button type="button" class="avatar-color-swatch" data-color="#4f73c9" style="background:#4f73c9;"></button>
                                    <button type="button" class="avatar-color-swatch" data-color="#6a6fe0" style="background:#6a6fe0;"></button>
                                    <button type="button" class="avatar-color-swatch" data-color="#8b6edb" style="background:#8b6edb;"></button>
                                    <button type="button" class="avatar-color-swatch" data-color="#c96aa6" style="background:#c96aa6;"></button>
                                    <button type="button" class="avatar-color-swatch" data-color="#cf6b6b" style="background:#cf6b6b;"></button>
                                    <button type="button" class="avatar-color-swatch" data-color="#d08a56" style="background:#d08a56;"></button>
                                    <button type="button" class="avatar-color-swatch" data-color="#c8a14a" style="background:#c8a14a;"></button>
                                    <button type="button" class="avatar-color-swatch" data-color="#64748b" style="background:#64748b;"></button>
                                </div>
                            </div>
                            <div class="avatar-upload-row">
                                <input type="file" id="avatarFileInput" accept="image/*" style="display:none;">
                                <button type="button" class="btn btn-secondary btn-small" id="avatarUploadBtn"><i class="fas fa-upload"></i> Upload Photo</button>
                                <button type="button" class="btn btn-secondary btn-small" id="avatarRemoveBtn"><i class="fas fa-trash"></i> Remove</button>
                            </div>
                            <div class="avatar-edit-row">
                                <button type="button" class="avatar-edit-btn" id="avatarZoomOut" title="Smaller"><i class="fas fa-minus"></i></button>
                                <span class="avatar-edit-pct" id="avatarEditorInfo">100%</span>
                                <button type="button" class="avatar-edit-btn" id="avatarZoomIn" title="Bigger"><i class="fas fa-plus"></i></button>
                                <span class="avatar-edit-hint">Drag photo to position</span>
                            </div>
                        </div>
                    </div>
                    <form id="profileForm">
                        <div class="form-grid">
                            <div class="form-group span-2">
                                <label for="profileFullName">Full Name</label>
                                <input type="text" id="profileFullName" required placeholder="Your full name">
                            </div>
                            <div class="form-group">
                                <label for="profileEmail">Email</label>
                                <input type="email" id="profileEmail" disabled>
                            </div>
                            <div class="form-group">
                                <label for="profileRole">User role</label>
                                <div class="role-display">
                                    <div id="profileRole" class="role-badge member">—</div>
                                </div>
                            </div>
                        </div>
                        <div class="form-actions">
                            <button type="button" class="btn btn-secondary" id="profileResetBtn">Reset</button>
                            <button type="submit" class="btn btn-primary"><i class="fas fa-save"></i> Save</button>
                        </div>
                    </form>
                </div>

                <!-- RECEIPT IDENTITY -->
                <div class="settings-card">
                    <div class="settings-card-header">
                        <div>
                            <div class="settings-card-title">Receipt Identity</div>
                            <div class="settings-card-subtitle">Information displayed on your receipts</div>
                        </div>
                    </div>
                    <div class="logo-compact">
                        <div class="logo-compact-label">Receipt Logo</div>
                        <div class="logo-compact-row">
                            <div class="logo-compact-preview" id="logoEditorCanvas">
                                <div class="logo-compact-placeholder" id="logoEditorPlaceholder"><i class="fas fa-image"></i></div>
                                <img class="logo-compact-img" id="logoEditorImage" alt="Logo" draggable="false">
                            </div>
                            <div class="logo-compact-controls">
                                <div class="logo-compact-zoom">
                                    <button type="button" class="logo-compact-btn" id="logoZoomOut" title="Smaller"><i class="fas fa-minus"></i></button>
                                    <span class="logo-compact-pct" id="logoEditorInfo">100%</span>
                                    <button type="button" class="logo-compact-btn" id="logoZoomIn" title="Bigger"><i class="fas fa-plus"></i></button>
                                </div>
                                <div class="logo-compact-actions">
                                    <input type="file" id="logoFileInput" accept="image/*" style="display:none;">
                                    <button type="button" class="btn btn-secondary btn-small" id="logoUploadBtn"><i class="fas fa-upload"></i> Upload</button>
                                    <button type="button" class="btn btn-secondary btn-small" id="logoRemoveBtn"><i class="fas fa-trash"></i> Remove</button>
                                </div>
                                <div class="logo-compact-hint">1200×600px PNG/JPG</div>
                            </div>
                        </div>
                    </div>
                    <form id="receiptForm">
                        <div class="form-grid">
                            <div class="form-group span-2">
                                <label for="receiptDisplayName">Display Name</label>
                                <input type="text" id="receiptDisplayName" placeholder="Name shown on receipts (e.g. your business name)">
                            </div>
                            <div class="form-group span-2">
                                <label for="receiptOtherId">Other ID</label>
                                <input type="text" id="receiptOtherId" placeholder="Optional">
                            </div>
                            <div class="form-group span-2">
                                <label for="receiptAddress">Address</label>
                                <textarea id="receiptAddress" rows="2" placeholder="Street, City, State, ZIP"></textarea>
                            </div>
                        </div>
                        <div class="form-actions">
                            <button type="button" class="btn btn-secondary" id="receiptResetBtn">Reset</button>
                            <button type="submit" class="btn btn-primary"><i class="fas fa-save"></i> Save</button>
                        </div>
                    </form>
                </div>

                <!-- SECURITY -->
                <div class="settings-card">
                    <div class="settings-card-header">
                        <div>
                            <div class="settings-card-title">Security</div>
                            <div class="settings-card-subtitle">Update your password</div>
                        </div>
                    </div>
                    <form id="passwordForm">
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="newPassword">New Password</label>
                                <input type="password" id="newPassword" placeholder="Min. 8 chars, uppercase, number, symbol">
                            </div>
                            <div class="form-group">
                                <label for="confirmPassword">Confirm Password</label>
                                <input type="password" id="confirmPassword" placeholder="Repeat password">
                            </div>
                        </div>
                        <div class="form-actions">
                            <button type="submit" class="btn btn-primary"><i class="fas fa-key"></i> Update Password</button>
                        </div>
                    </form>
                </div>

                <!-- DELETE ACCOUNT (collapsible) -->
                <div class="settings-card danger-card collapsible-card">
                    <div class="collapsible-header" id="deleteAccountToggle">
                        <div class="collapsible-header-left">
                            <i class="fas fa-trash-alt" style="color:#dc2626;"></i>
                            <div>
                                <div class="settings-card-title">Delete Account</div>
                                <div class="settings-card-subtitle">Permanently delete your account and all data</div>
                            </div>
                        </div>
                        <i class="fas fa-chevron-down collapsible-icon"></i>
                    </div>
                    <div class="collapsible-content" id="deleteAccountContent">
                        <div class="danger-warning">
                            <i class="fas fa-exclamation-triangle"></i>
                            <div class="danger-warning-text">
                                <strong>Warning: This action cannot be undone</strong>
                                <ul>
                                    <li>All Cash Boxes will be permanently deleted</li>
                                    <li>All transactions and receipts will be lost</li>
                                    <li>Your subscription will be cancelled immediately</li>
                                </ul>
                            </div>
                        </div>
                        <div class="form-grid">
                            <div class="form-group span-2">
                                <label for="deleteConfirmInput">Type "DELETE" to confirm</label>
                                <input type="text" id="deleteConfirmInput" placeholder="DELETE">
                            </div>
                        </div>
                        <div class="form-actions">
                            <button type="button" class="btn btn-secondary" id="deleteAccountBtn" style="color:#dc2626;border-color:rgba(239,68,68,0.3);"><i class="fas fa-trash"></i> Delete Account</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- RIGHT COLUMN -->
            <div>
                <!-- TEAM MANAGEMENT -->
                <div class="settings-card">
                    <div class="settings-card-header">
                        <div>
                            <div class="settings-card-title">Team Management <span class="badge badge-warning">PRO</span></div>
                            <div class="settings-card-subtitle">Manage members and their permissions</div>
                        </div>
                        <div class="team-header-actions">
                            <button type="button" class="btn btn-secondary btn-small" id="manageAccessBtn"><i class="fas fa-key"></i> Cash Box Access</button>
                            <button type="button" class="btn btn-primary btn-small" id="inviteMemberBtn"><i class="fas fa-user-plus"></i> Invite</button>
                        </div>
                    </div>
                    <div class="stats-row">
                        <div class="stat-box">
                            <div class="stat-label">Total Members</div>
                            <div class="stat-value" id="statTotalMembers">—</div>
                            <div class="stat-note" id="statMembersNote">Loading...</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-label">Active</div>
                            <div class="stat-value" id="statActiveMembers">—</div>
                            <div class="stat-note">Members active</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-label">Pending</div>
                            <div class="stat-value" id="statPendingMembers">—</div>
                            <div class="stat-note">Awaiting acceptance</div>
                        </div>
                    </div>
                    <div class="team-table-wrap">
                        <table class="team-table">
                            <thead>
                                <tr>
                                    <th>Member</th>
                                    <th>Role</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="teamTableBody">
                                <tr><td colspan="4" style="text-align:center;color:var(--text-muted);padding:24px;"><i class="fas fa-spinner fa-spin"></i> Loading team...</td></tr>
                            </tbody>
                        </table>
                    </div>
                    <div style="margin-top:16px;font-size:12px;color:var(--text-muted);"><i class="fas fa-info-circle"></i> Admins can access all Cash Boxes. Configure per-cash-box access for Users via "Cash Box Access".</div>
                </div>

                <!-- SUBSCRIPTION & BILLING -->
                <div class="settings-card">
                    <div class="settings-card-header">
                        <div>
                            <div class="settings-card-title">Subscription & Billing</div>
                            <div class="settings-card-subtitle">Manage your plan and payment details</div>
                        </div>
                    </div>
                    <div class="billing-info">
                        <div class="billing-info-left">
                            <i class="fas fa-calendar-check"></i>
                            <div class="billing-info-text">
                                <span>You're on <strong id="currentPlanName">Standard (Yearly)</strong></span>
                                <div id="nextBillingInfo">Next billing: Feb 1, 2026 • $190.00</div>
                            </div>
                        </div>
                        <button type="button" class="btn btn-secondary btn-small" id="cancelSubscriptionBtn"><i class="fas fa-times"></i> Cancel</button>
                    </div>
                    <div class="billing-toggle">
                        <span class="billing-toggle-label" id="monthlyLabel">Monthly</span>
                        <div class="toggle-switch yearly" id="billingToggle"><div class="toggle-switch-slider"></div></div>
                        <span class="billing-toggle-label active" id="yearlyLabel">Yearly <span class="badge badge-warning" style="font-size:10px;">SAVE 20%</span></span>
                    </div>
                    <div class="plan-cards">
                        <div class="plan-card">
                            <div class="plan-name">Free Trial</div>
                            <div class="plan-desc">14 days or 20 receipts</div>
                            <div class="plan-price">$0</div>
                            <div class="plan-period">Try it out</div>
                            <ul class="plan-features">
                                <li><i class="fas fa-check"></i> 1 Cash Box</li>
                                <li><i class="fas fa-check"></i> 1 user</li>
                                <li><i class="fas fa-check"></i> 20 receipts</li>
                                <li><i class="fas fa-check"></i> Basic templates</li>
                            </ul>
                            <button class="btn btn-secondary btn-small" style="width:100%;opacity:0.5;cursor:not-allowed;" disabled>Trial Expired</button>
                        </div>
                        <div class="plan-card current">
                            <div class="plan-badge current">Current Plan</div>
                            <div class="plan-name">Standard</div>
                            <div class="plan-desc">Solo users & small teams</div>
                            <div class="plan-price" id="standardPrice">$190</div>
                            <div class="plan-period" id="standardPeriod">per year</div>
                            <div class="plan-savings" id="standardSavings">Save $38 vs monthly</div>
                            <ul class="plan-features">
                                <li><i class="fas fa-check"></i> 2 Cash Boxes</li>
                                <li><i class="fas fa-check"></i> 1 user</li>
                                <li><i class="fas fa-check"></i> Unlimited transactions</li>
                                <li><i class="fas fa-check"></i> Custom logo upload</li>
                                <li><i class="fas fa-check"></i> Customizable receipt layouts</li>
                                <li><i class="fas fa-check"></i> PDF & CSV export</li>
                            </ul>
                            <button class="btn btn-secondary btn-small" style="width:100%;opacity:0.5;cursor:not-allowed;" disabled>Current Plan</button>
                        </div>
                        <div class="plan-card popular">
                            <div class="plan-badge popular">Most Popular</div>
                            <div class="plan-name">Pro</div>
                            <div class="plan-desc">Growing teams</div>
                            <div class="plan-price" id="proPrice">$290</div>
                            <div class="plan-period" id="proPeriod">per year</div>
                            <div class="plan-savings" id="proSavings">Save $58 vs monthly</div>
                            <ul class="plan-features">
                                <li><i class="fas fa-check"></i> Customizable text & labels (localization)</li>
                                <li><i class="fas fa-check"></i> 3 users included</li>
                                <li><i class="fas fa-check"></i> +$5/mo per extra user</li>
                                <li><i class="fas fa-check"></i> Unlimited Cash Boxes</li>
                                <li><i class="fas fa-check"></i> Unlimited transactions</li>
                                <li><i class="fas fa-check"></i> Email receipts directly</li>
                                <li><i class="fas fa-check"></i> Role-based permissions</li>
                                <li><i class="fas fa-check"></i> All Standard features</li>
                            </ul>
                            <button class="btn btn-primary btn-small" style="width:100%;background:var(--orange);" id="upgradeProBtn">Upgrade to Pro</button>
                        </div>
                    </div>
                    <div style="text-align:center;margin-top:20px;">
                        <button type="button" class="btn btn-secondary" id="manageBillingBtn"><i class="fas fa-credit-card"></i> Manage Billing & Invoices</button>
                    </div>
                </div>
            </div>
        </div>
    </main>
</div>

<!-- MODAL: Invite Member -->
<div class="modal-backdrop" id="inviteModal">
    <div class="modal-content">
        <div class="modal-header">
            <div class="modal-title">Invite Team Member</div>
            <button type="button" class="modal-close" id="inviteModalClose">&times;</button>
        </div>
        <div class="modal-body">
            <div class="form-group" style="margin-bottom:16px;">
                <label for="inviteEmail">Email Address</label>
                <input type="email" id="inviteEmail" required placeholder="colleague@example.com">
            </div>
            <div class="form-group">
                <label for="inviteRole">Role</label>
                <select id="inviteRole">
                    <option value="member">Member — Can record transactions</option>
                    <option value="admin">Admin — Full access to assigned Cash Boxes</option>
                </select>
            </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-secondary" id="inviteModalCancel">Cancel</button>
            <button type="button" class="btn btn-primary" id="inviteModalSubmit"><i class="fas fa-paper-plane"></i> Send Invite</button>
        </div>
    </div>
</div>

<!-- MODAL: Cash Box Access -->
<div class="modal-backdrop" id="accessModal">
    <div class="modal-content">
        <div class="modal-header">
            <div class="modal-title">Manage Cash Box Access</div>
            <button type="button" class="modal-close" id="accessModalClose">&times;</button>
        </div>
        <div class="modal-body">
            <div id="accessMemberPickerWrap" style="display:none;margin-bottom:14px;">
                <label for="accessMemberSelect" style="display:block;font-size:12px;font-weight:700;color:var(--text-muted);text-transform:uppercase;letter-spacing:0.04em;margin-bottom:6px;">Member</label>
                <select id="accessMemberSelect" class="team-role-select" style="width:100%;padding:10px 12px;border-radius:10px;border:1px solid var(--border);background:var(--surface);"></select>
            </div>
            <div style="margin-bottom:16px;">
                <strong id="accessMemberName">—</strong>
                <div style="font-size:13px;color:var(--text-muted);" id="accessMemberEmail">—</div>
            </div>
            <div style="font-size:13px;margin-bottom:12px;color:var(--text-muted);">Select which Cash Boxes this member can access:</div>
            <div class="access-list" id="accessCashBoxList">
                <div style="text-align:center;color:var(--text-muted);padding:20px;"><i class="fas fa-spinner fa-spin"></i> Loading...</div>
            </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-secondary" id="accessModalClose2">Close</button>
        </div>
    </div>
</div>

<!-- Footer -->
<footer class="app-footer">
    <div class="app-footer-container">
        <div class="app-footer-top">
            <div class="app-footer-brand">
                <a href="dashboard.html" class="app-footer-brand-logo">
                    <svg width="32" height="32" viewBox="0 0 48 48" fill="none"><path d="M10 6 C10 4.89543 10.8954 4 12 4 L36 4 C37.1046 4 38 4.89543 38 6 L38 38 L36 40 L34 38 L32 40 L30 38 L28 40 L26 38 L24 40 L22 38 L20 40 L18 38 L16 40 L14 38 L12 40 L10 38 Z" fill="white"/><path d="M32 4 L38 10 L32 10 Z" fill="rgba(0,0,0,0.15)"/></svg>
                    <span>SpendNote</span>
                </a>
                <p class="app-footer-brand-desc">Cash receipt management for modern teams.</p>
            </div>
            <div class="app-footer-right">
                <div class="app-footer-links-simple">
                    <a href="index.html#features">Features</a>
                    <a href="spendnote-pricing.html">Pricing</a>
                    <a href="spendnote-faq.html">FAQ</a>
                    <a href="spendnote-terms.html">Legal</a>
                </div>
                <div class="app-footer-brand-disclaimer"><i class="fas fa-info-circle"></i><span>Cash handoff documentation only. Not a tax or accounting tool.</span></div>
            </div>
        </div>
        <div class="app-footer-bottom"><div class="app-footer-copyright">2026 SpendNote. All rights reserved.</div></div>
    </div>
</footer>

<script src="assets/js/modal-dialogs.js?v=20260208-1900"></script>
<script src="assets/js/logo-editor.js?v=20260215-2335"></script>
<script src="assets/js/user-settings.js?v=20260217-0202"></script>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="assets/js/supabase-config.js?v=20260216-2236"></script>
<script src="assets/js/auth-guard.js?v=20260213-1658"></script>
<script src="assets/js/nav-loader.js?v=20260217-0200"></script>
<script>loadNav();</script>
<script src="assets/js/main.js?v=20260217-2001"></script>
</body>
</html>
