<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow">
    <meta name="description" content="Manage your team members and permissions in SpendNote.">
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="alternate icon" type="image/x-icon" href="favicon.ico">
    <title>Team Management - SpendNote</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="assets/css/main.css?v=23">
    <link rel="stylesheet" href="assets/css/app-layout.css?v=19">
    <link rel="stylesheet" href="assets/css/user-settings.css?v=20260223-2100">
    <link rel="stylesheet" href="assets/css/team-page.css?v=20260223-2150">
</head>
<body>
<div id="nav-container"></div>

<div class="app-container team-page-compact">
    <main class="main-content">
        <div class="page-header">
            <div class="page-title-group">
                <h1 class="page-title">Team Management <span class="badge badge-warning" style="font-size:13px;vertical-align:middle;">PRO</span></h1>
                <p class="page-subtitle">Manage who can access your Cash Boxes.</p>
            </div>
            <div class="page-header-actions" id="teamHeaderActions" style="display:none;">
                <button type="button" class="btn btn-primary" id="inviteMemberBtn"><i class="fas fa-user-plus"></i> Invite Member</button>
            </div>
        </div>

        <!-- LOADING STATE -->
        <div id="teamLoading" style="text-align:center;padding:60px 24px;color:var(--text-muted);">
            <i class="fas fa-spinner fa-spin" style="font-size:24px;margin-bottom:12px;display:block;"></i>
            Loading team data...
        </div>

        <!-- ERROR STATE -->
        <div id="teamError" style="display:none;text-align:center;padding:48px 24px;" class="settings-card">
            <i class="fas fa-exclamation-triangle" style="font-size:32px;color:#f59e0b;margin-bottom:12px;display:block;"></i>
            <div style="font-size:16px;font-weight:600;margin-bottom:8px;">Could not load team data</div>
            <div style="color:var(--text-muted);margin-bottom:16px;" id="teamErrorMsg">Please check your connection and try again.</div>
            <button type="button" class="btn btn-secondary" onclick="location.reload()"><i class="fas fa-redo"></i> Retry</button>
        </div>

        <!-- MAIN CONTENT (hidden until loaded) -->
        <div id="teamContent" style="display:none;">

            <!-- STATS -->
            <div class="stats-row" style="margin-bottom:24px;">
                <div class="stat-box">
                    <div class="stat-label">Team Members</div>
                    <div class="stat-value" id="statTotalMembers">0</div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">Cash Boxes</div>
                    <div class="stat-value" id="statCashBoxes">0</div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">Pending Invites</div>
                    <div class="stat-value" id="statPendingMembers">0</div>
                </div>
            </div>

            <!-- MEMBERS TABLE (primary) -->
            <div class="settings-card" style="margin-bottom:24px;">
                <div class="settings-card-header">
                    <div>
                        <div class="settings-card-title">Team Members</div>
                        <div class="settings-card-subtitle">Everyone in your organization</div>
                    </div>
                </div>
                <div class="team-table-wrap">
                    <table class="team-table">
                        <thead>
                            <tr>
                                <th>Member</th>
                                <th>Role</th>
                                <th>Cash Boxes</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="teamTableBody"></tbody>
                    </table>
                </div>
            </div>

            <!-- CASH BOX ACCESS (compact list) -->
            <div class="settings-card">
                <div class="settings-card-header">
                    <div>
                        <div class="settings-card-title">Cash Box Access</div>
                        <div class="settings-card-subtitle">Who can access each Cash Box</div>
                    </div>
                </div>
                <div id="cashBoxGrid" class="team-cb-list-wrap">
                    <!-- Populated by JS -->
                </div>
            </div>
        </div>
    </main>
</div>

<!-- MODAL: Invite Member (with Cash Box selection) -->
<div class="modal-backdrop" id="inviteModal">
    <div class="modal-content">
        <div class="modal-header">
            <div class="modal-title">Invite Team Member</div>
            <button type="button" class="modal-close" id="inviteModalClose">&times;</button>
        </div>
        <div class="modal-body">
            <div class="form-group" style="margin-bottom:16px;">
                <label for="inviteEmail">Email Address</label>
                <input type="email" id="inviteEmail" required placeholder="colleague@example.com">
            </div>
            <div class="form-group" style="margin-bottom:16px;">
                <label for="inviteRole">Role</label>
                <select id="inviteRole">
                    <option value="user">User — Can record transactions in assigned Cash Boxes</option>
                    <option value="admin">Admin — Full access to all Cash Boxes</option>
                </select>
            </div>
            <div class="form-group" id="inviteCashBoxGroup">
                <label>Cash Box Access</label>
                <div class="invite-cb-hint" style="font-size:12px;color:var(--text-muted);margin-bottom:8px;">Select which Cash Boxes this member can use. Admins get access to all.</div>
                <div id="inviteCashBoxList" class="invite-cb-list">
                    <!-- Populated by JS -->
                </div>
            </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-secondary" id="inviteModalCancel">Cancel</button>
            <button type="button" class="btn btn-primary" id="inviteModalSubmit"><i class="fas fa-paper-plane"></i> Send Invite</button>
        </div>
    </div>
</div>

<!-- MODAL: Manage Access for a Cash Box -->
<div class="modal-backdrop" id="accessModal">
    <div class="modal-content">
        <div class="modal-header">
            <div class="modal-title" id="accessModalTitle">Manage Access</div>
            <button type="button" class="modal-close" id="accessModalClose">&times;</button>
        </div>
        <div class="modal-body">
            <div style="font-size:13px;margin-bottom:12px;color:var(--text-muted);">Toggle access for team members:</div>
            <div id="accessMemberList" class="access-list"></div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-secondary" id="accessModalDone">Done</button>
        </div>
    </div>
</div>

<!-- Footer -->
<footer class="app-footer">
    <div class="app-footer-container">
        <div class="app-footer-top">
            <div class="app-footer-brand">
                <a href="dashboard.html" class="app-footer-brand-logo">
                    <svg width="32" height="32" viewBox="0 0 48 48" fill="none"><path d="M10 6 C10 4.89543 10.8954 4 12 4 L36 4 C37.1046 4 38 4.89543 38 6 L38 38 L36 40 L34 38 L32 40 L30 38 L28 40 L26 38 L24 40 L22 38 L20 40 L18 38 L16 40 L14 38 L12 40 L10 38 Z" fill="white"/><path d="M32 4 L38 10 L32 10 Z" fill="rgba(0,0,0,0.15)"/></svg>
                    <span>SpendNote</span>
                </a>
                <p class="app-footer-brand-desc">Cash receipt management for modern teams.</p>
            </div>
            <div class="app-footer-right">
                <div class="app-footer-links-simple">
                    <a href="index.html#features">Features</a>
                    <a href="spendnote-pricing.html">Pricing</a>
                    <a href="spendnote-faq.html">FAQ</a>
                    <a href="spendnote-terms.html">Legal</a>
                </div>
                <div class="app-footer-brand-disclaimer"><i class="fas fa-info-circle"></i><span>Cash handoff documentation only. Not a tax or accounting tool.</span></div>
            </div>
        </div>
        <div class="app-footer-bottom"><div class="app-footer-copyright">2026 SpendNote. All rights reserved.</div></div>
    </div>
</footer>

<script src="assets/js/modal-dialogs.js?v=20260208-1900"></script>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="assets/js/supabase-config.js?v=20260223-1949"></script>
<script src="assets/js/auth-guard.js?v=20260223-1949"></script>
<script src="assets/js/nav-loader.js?v=20260223-2101"></script>
<script>loadNav();</script>
<script src="assets/js/main.js?v=26"></script>
<script src="assets/js/team-page.js?v=20260223-2146"></script>
</body>
</html>
